'\" te
.TH 3Drelocate 1
.SH NAME
3Drelocate - relocate events using static travel-time files
.SH SYNOPSIS
.nf
3Drelocate [-h] [-v]  [-p \fIpf\fP] [-s \fIsubset\fP] [-l \fIlogfile\fP] db
.fi
.SH DESCRIPTION
\fB3Drelocate\fR relocates events by minimizing travel-time residuals between
observations and predicted arrival times. This piece of software is designed
to work in tandem with output travel-time files from \fBgenerate_ttimes_fm3d\fR
which allows for 3D velocity heterogeneities. Travel-time files generated using
\fBgenerate_ttimes_fm3d\fR are linked to \fB3Drelocate\fR via the
\fItt_map_dir\fR parameter.
.SH OPTIONS
.IP "-h"
Display help info.
.IP "-p pf"
Specify alternate parameter file; the default is 3Drelocate.pf.
.IP "-s subset"
Subset of events to relocate.
.IP "-l logfile"
Name of log file; the default is 3Drelocate.log
.SH FILES
\fB3Drelocate\fR requires input travel-time files generated by
\fBgenerate_ttimes_fm3d\fR.
.SH PARAMETER FILE
An example of the paramater file is:
.in 2c
.ft CW
.nf

.ne 23
################################################################################
#3Drelocate specific parameters
#
#These parameters are used only by program 3Drelocate.
################################################################################
tt_map_dir              ${BASEDIR}/data/3Drelocate/ttimes #Location of travel-time files generated by 'generate_ttimes_fm3d'
use_S                   True  #Set to False if only P-wave arrivals should be used in inversion.
max_iterations          100   #Maximum number of inversion update iterations
sdobs_stable_thresh     0.001 #Stop inversion update iteration when sdobs changes by less than this value

################################################################################
#generate_ttimes_fm3d specific parameters
#
#These parameters are used only by program generate_ttimes_fm3d.
################################################################################
calc_S_tt               True  #Set to False if only P-wave travel times should be calculated by 'generate_ttimes_fm3d' (eg. No S-wave velocity model is available).

#The following set of parameters point to the location of various input files
frechet.in              ${BASEDIR}/locate/fm3d/frechet.in
gridsave.in             ${BASEDIR}/locate/fm3d/gridsave.in
interfaces.in           ${BASEDIR}/locate/fm3d/interfaces.in
mode_set.in             ${BASEDIR}/locate/fm3d/mode_set.in
receivers.in            ${BASEDIR}/locate/fm3d/receivers.in
vgrids_P                ${BASEDIR}/locate/fm3d/Vp/vgrids.in
vgrids_S                ${BASEDIR}/locate/fm3d/Vs/vgrids.in

################################################################################
#generate_ttimes_fm3d + 3Drelocate shared parameters
#
#These parameters are used by both programs generate_ttimes_fm3d and 3Drelocate.
################################################################################
earth_radius            6371.0 #Barring supernatural causes, this shouldn't change
#This defines the grid of nodes for which travel-times are calculated
propagation_grid &Arr{
    minlat      32.5     #Minimum latitude
    minlon      -117.80  #Minimum longitude
    minr        6326.0   #Minimum radius
    nlat        76       #Number of nodes along latitude axis
    nlon        73       #Number of nodes along longitude axis
    nr          25       #Number of nodes along radial axis
    dlat        0.0273   #Node spacing along latitude axis
    dlon        0.0327   #Node spacing along longitude axis
    dr          2.0      #Node spacing along radial axis
}
.fi
.ft P
.in
.SH EXAMPLE
sh$ \fB3Drelocate -s 'time >= _2013001_ && time < _2013032_' -l reloc_Jan.log anza_2013\fR
.in 2c
.ft CW
.nf
.fi
.ft R
.in
.SH "SEE ALSO"
.nf
generate_ttimes_fm3d(1)
.fi
.SH AUTHOR
Malcolm White - UCSD

Amir Allam - UAF
